rules:
  # Example: flag insecure crypto primitives
  - id: insecure-crypto-usage
    message: Found insecure crypto usage (md5/sha1)
    languages: [python]
    severity: ERROR
    pattern-either:
      - pattern: hashlib.sha1(...)
      - pattern: hashlib.md5(...)

  # Example: avoid open file never closed
  - id: open-never-closed
    languages: [python]
    severity: WARNING
    message: file object opened without corresponding close
    patterns:
      - pattern: $F = open(...)
      - pattern-not-inside: |
          $F = open(...)
          ...
          $F.close()

