name: Stale Issue Management

on:
  schedule:
    - cron: "0 12 * * *"  # Run daily at 12:00 UTC
  workflow_dispatch:  # Allow manual trigger

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          # Days before marking stale
          days-before-stale: 14

          # Days before closing stale issues
          days-before-close: 7

          # Issues with these labels will never be marked stale
          exempt-issue-labels: 'roadmap,python-3.14,python-3.15,enhancement'

          # PRs with these labels will never be marked stale
          exempt-pr-labels: 'roadmap,python-3.14,python-3.15'

          # Only stale issues/PRs with these labels (questions and bugs get stale, enhancements don't)
          only-issue-labels: 'question,bug,needs-triage'

          # Messages
          stale-issue-message: |
            üëã This issue has been automatically marked as stale because it has not had recent activity.

            **What happens next?**
            - If this is still relevant, please comment to keep it open
            - If no activity occurs within 7 days, this issue will be automatically closed
            - You can always reopen if needed later

            Thank you for your contribution! üôè

          close-issue-message: |
            üîí This issue has been automatically closed due to inactivity.

            **Need to reopen?** Just comment on this issue and we'll reopen it for you.

            **Still experiencing this problem?** Feel free to open a new issue with updated information.

            Thanks for using injx! ‚ú®

          stale-pr-message: |
            üëã This pull request has been automatically marked as stale because it has not had recent activity.

            **What happens next?**
            - If you're still working on this, please comment or push new commits
            - If no activity occurs within 7 days, this PR will be automatically closed
            - You can always reopen or submit a new PR later

            Thank you for your contribution! üôè

          close-pr-message: |
            üîí This pull request has been automatically closed due to inactivity.

            **Want to continue this work?**
            - Reopen this PR with a comment
            - Or submit a new PR with your changes

            Thanks for contributing to injx! ‚ú®

          # Labels to add
          stale-issue-label: 'stale'
          stale-pr-label: 'stale'

          # Remove stale label when there's new activity
          remove-stale-when-updated: true

          # Don't mark issues stale if they have recent comments from collaborators
          ignore-issue-updates: false
          ignore-pr-updates: false

          # Limit the number of operations per run to avoid hitting API limits
          operations-per-run: 50

          # Enable debug logging
          debug-only: false
